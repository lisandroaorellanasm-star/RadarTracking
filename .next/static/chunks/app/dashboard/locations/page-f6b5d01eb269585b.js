(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[771],{7954:function(e,r,t){Promise.resolve().then(t.bind(t,3175))},3175:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return b}});var a=t(3827),s=t(4090),l=t(1543),n=t(9313),i=t(4203),o=t(5787),d=t(9755);function c(e){let{center:r={lat:40.7128,lng:-74.006},zoom:t=12,locations:l=[],onMapClick:n}=e,i=(0,s.useRef)(null),[o,c]=(0,s.useState)(null),[u,x]=(0,s.useState)([]),[m,g]=(0,s.useState)([]),[h,f]=(0,s.useState)(!0),[p,b]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{let e="AIzaSyCJRM9Zd6j-mXfj6cnusW-QKj331gRQlw0";if(!e){b("API key de Google Maps no configurada"),f(!1);return}let a=new d.aN({apiKey:e,version:"weekly"});try{if(f(!0),await a.load(),!window.google||!window.google.maps)throw Error("Google Maps API failed to load");if(i.current){let e=new window.google.maps.Map(i.current,{center:r,zoom:t,mapTypeControl:!0,streetViewControl:!1,fullscreenControl:!0,zoomControl:!0,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]});c(e),f(!1),n&&e.addListener("click",e=>{e.latLng&&n(e.latLng.lat(),e.latLng.lng())})}}catch(e){console.error("Error loading Google Maps:",e),b(e.message||"Error al cargar Google Maps"),f(!1)}})()},[]),(0,s.useEffect)(()=>{if(!o||!window.google||!window.google.maps)return;u.forEach(e=>e.setMap(null)),m.forEach(e=>e.setMap(null));let e=[],r=[];if(l.forEach(t=>{let a=new window.google.maps.Marker({position:{lat:t.latitude,lng:t.longitude},map:o,title:t.name,icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:10,fillColor:"#FF6B35",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2}}),s=new window.google.maps.InfoWindow({content:'\n          <div style="padding: 8px;">\n            <h3 style="margin: 0 0 4px 0; font-weight: bold; color: #1F2937;">'.concat(t.name,'</h3>\n            <p style="margin: 0; color: #6B7280; font-size: 14px;">Radio: ').concat(t.geofence_radius,"m</p>\n          </div>\n        ")});a.addListener("click",()=>{s.open(o,a)}),e.push(a);let l=new window.google.maps.Circle({strokeColor:"#FF6B35",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF6B35",fillOpacity:.15,map:o,center:{lat:t.latitude,lng:t.longitude},radius:t.geofence_radius});r.push(l)}),x(e),g(r),l.length>0&&window.google&&window.google.maps){let e=new window.google.maps.LatLngBounds;l.forEach(r=>{e.extend({lat:r.latitude,lng:r.longitude})}),o.fitBounds(e)}},[o,l]),(0,a.jsxs)("div",{className:"relative w-full h-full",style:{minHeight:"400px"},children:[h&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100 rounded-xl",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-orange-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Cargando mapa..."})]})}),p&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-red-50 rounded-xl",children:(0,a.jsxs)("div",{className:"text-center p-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Error al cargar el mapa"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:p}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-4 text-left",children:[(0,a.jsx)("p",{className:"text-xs text-gray-700 mb-2",children:(0,a.jsx)("strong",{children:"Posibles soluciones:"})}),(0,a.jsxs)("ul",{className:"text-xs text-gray-600 space-y-1",children:[(0,a.jsx)("li",{children:"• Verifica que la API key est\xe9 correcta en .env.local"}),(0,a.jsx)("li",{children:'• Habilita "Maps JavaScript API" en Google Cloud Console'}),(0,a.jsx)("li",{children:"• Agrega localhost:3000 a las restricciones de la API key"})]})]})]})}),(0,a.jsx)("div",{ref:i,className:"w-full h-full rounded-xl overflow-hidden shadow-lg",style:{minHeight:"400px",display:h||p?"none":"block"}})]})}var u=t(8998);class x extends s.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.error("ErrorBoundary caught an error:",e,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,a.jsx)("div",{className:"w-full h-full min-h-[400px] flex items-center justify-center bg-red-50 rounded-xl border border-red-200",children:(0,a.jsxs)("div",{className:"text-center p-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(u.Z,{className:"w-6 h-6 text-red-600"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Algo sali\xf3 mal"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4 max-w-xs mx-auto",children:"No se pudo cargar este componente. Por favor intenta recargar la p\xe1gina."}),this.state.error&&(0,a.jsx)("div",{className:"text-xs text-left bg-white p-2 rounded border border-gray-200 overflow-auto max-h-32 w-full max-w-xs mx-auto",children:(0,a.jsx)("code",{className:"text-red-800 break-words",children:this.state.error.message})})]})}):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null}}}var m=t(94),g=t(2457),h=t(1361),f=t(9295),p=t(6806);function b(){let[e,r]=(0,s.useState)(!1),[t,d]=(0,s.useState)(null);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Ubicaciones"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Gestiona tus ubicaciones y configura geofences"})]}),(0,a.jsxs)(n.z,{onClick:()=>r(!0),children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),"Nueva Ubicaci\xf3n"]})]}),(0,a.jsx)(l.Zb,{children:(0,a.jsx)(l.aY,{className:"pt-6",children:(0,a.jsx)(x,{children:(0,a.jsx)(c,{center:{lat:40.416775,lng:-3.70379},zoom:12,locations:y.map(e=>({id:e.name,name:e.name,latitude:e.latitude,longitude:e.longitude,geofence_radius:e.geofenceRadius}))})})})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map((e,r)=>(0,a.jsx)(l.Zb,{className:"hover:shadow-xl transition-shadow",children:(0,a.jsxs)(l.aY,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-1",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:e.address})]}),(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat(e.isActive?"bg-green-100":"bg-gray-100"),children:(0,a.jsx)(g.Z,{className:"w-5 h-5 ".concat(e.isActive?"text-green-600":"text-gray-600")})})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Radio: ",e.geofenceRadius,"m"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Coordenadas: ",e.latitude,", ",e.longitude]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Visitas Hoy"}),(0,a.jsx)("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:e.visitsToday})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Clientes Cerca"}),(0,a.jsx)("p",{className:"text-lg font-bold text-primary-600",children:e.customersNearby})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-4",children:[(0,a.jsxs)(n.z,{size:"sm",variant:"ghost",className:"flex-1",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 mr-1"}),"Editar"]}),(0,a.jsxs)(n.z,{size:"sm",variant:"ghost",className:"flex-1",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-1"}),"Eliminar"]})]})]})},r))}),(0,a.jsx)(o.u,{isOpen:e,onClose:()=>r(!1),title:"Nueva Ubicaci\xf3n",size:"lg",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(i.II,{label:"Nombre de la Ubicaci\xf3n",placeholder:"Ej: Tienda Centro"}),(0,a.jsx)(i.II,{label:"Direcci\xf3n",placeholder:"Calle Principal 123, Ciudad"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(i.II,{label:"Latitud",type:"number",step:"0.000001",placeholder:"40.416775"}),(0,a.jsx)(i.II,{label:"Longitud",type:"number",step:"0.000001",placeholder:"-3.703790"})]}),(0,a.jsx)(i.II,{label:"Radio del Geofence (metros)",type:"number",placeholder:"100"}),(0,a.jsx)("div",{className:"p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["\uD83D\uDCA1 ",(0,a.jsx)("strong",{children:"Consejo:"})," Puedes hacer clic en el mapa para seleccionar las coordenadas autom\xe1ticamente."]})}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)(n.z,{className:"flex-1",children:"Guardar Ubicaci\xf3n"}),(0,a.jsx)(n.z,{variant:"ghost",className:"flex-1",onClick:()=>r(!1),children:"Cancelar"})]})]})})]})}let y=[{name:"Tienda Centro",address:"Calle Mayor 45, Madrid",latitude:40.416775,longitude:-3.70379,geofenceRadius:100,isActive:!0,visitsToday:45,customersNearby:12},{name:"Tienda Norte",address:"Av. de la Castellana 120, Madrid",latitude:40.465631,longitude:-3.688344,geofenceRadius:150,isActive:!0,visitsToday:32,customersNearby:8},{name:"Tienda Sur",address:"Calle de Atocha 89, Madrid",latitude:40.408566,longitude:-3.693514,geofenceRadius:100,isActive:!0,visitsToday:28,customersNearby:5},{name:"Tienda Este",address:"Calle de Alcal\xe1 200, Madrid",latitude:40.426371,longitude:-3.66891,geofenceRadius:120,isActive:!1,visitsToday:0,customersNearby:0}]},9313:function(e,r,t){"use strict";t.d(r,{z:function(){return l}});var a=t(3827);t(4090);var s=t(1657);function l(e){let{children:r,variant:t="primary",size:l="md",isLoading:n=!1,className:i,disabled:o,...d}=e;return(0,a.jsxs)("button",{className:(0,s.cn)("inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white shadow-lg hover:shadow-xl focus:ring-primary-500",secondary:"bg-gradient-to-r from-secondary-500 to-secondary-600 hover:from-secondary-600 hover:to-secondary-700 text-white shadow-lg hover:shadow-xl focus:ring-secondary-500",danger:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white shadow-lg hover:shadow-xl focus:ring-red-500",ghost:"bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300",outline:"bg-transparent border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}[t],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[l],i),disabled:o||n,...d,children:[n&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r]})}},1543:function(e,r,t){"use strict";t.d(r,{Ol:function(){return n},Zb:function(){return l},aY:function(){return o},ll:function(){return i}});var a=t(3827);t(4090);var s=t(1657);function l(e){let{children:r,className:t,glass:l=!1}=e;return(0,a.jsx)("div",{className:(0,s.cn)("rounded-xl p-6 shadow-lg",l?"glass":"bg-white dark:bg-gray-800",t),children:r})}function n(e){let{children:r,className:t}=e;return(0,a.jsx)("div",{className:(0,s.cn)("mb-4",t),children:r})}function i(e){let{children:r,className:t}=e;return(0,a.jsx)("h3",{className:(0,s.cn)("text-xl font-bold text-gray-900 dark:text-white",t),children:r})}function o(e){let{children:r,className:t}=e;return(0,a.jsx)("div",{className:(0,s.cn)(t),children:r})}},4203:function(e,r,t){"use strict";t.d(r,{II:function(){return l},Ph:function(){return i},gx:function(){return n}});var a=t(3827);t(4090);var s=t(1657);function l(e){let{label:r,error:t,icon:l,className:n,...i}=e;return(0,a.jsxs)("div",{className:"w-full",children:[r&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r}),(0,a.jsxs)("div",{className:"relative",children:[l&&(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l}),(0,a.jsx)("input",{className:(0,s.cn)("w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all","bg-white dark:bg-gray-800 text-gray-900 dark:text-white","border-gray-300 dark:border-gray-600",t&&"border-red-500 focus:ring-red-500",l&&"pl-10",n),...i})]}),t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t})]})}function n(e){let{label:r,error:t,className:l,...n}=e;return(0,a.jsxs)("div",{className:"w-full",children:[r&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r}),(0,a.jsx)("textarea",{className:(0,s.cn)("w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all","bg-white dark:bg-gray-800 text-gray-900 dark:text-white","border-gray-300 dark:border-gray-600",t&&"border-red-500 focus:ring-red-500",l),...n}),t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t})]})}function i(e){let{label:r,error:t,options:l,className:n,...i}=e;return(0,a.jsxs)("div",{className:"w-full",children:[r&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r}),(0,a.jsx)("select",{className:(0,s.cn)("w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all","bg-white dark:bg-gray-800 text-gray-900 dark:text-white","border-gray-300 dark:border-gray-600",t&&"border-red-500 focus:ring-red-500",n),...i,children:l.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t})]})}},5787:function(e,r,t){"use strict";t.d(r,{u:function(){return i}});var a=t(3827),s=t(4090),l=t(1657),n=t(2235);function i(e){let{isOpen:r,onClose:t,title:i,children:o,size:d="md"}=e;return((0,s.useEffect)(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[r]),r)?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),(0,a.jsxs)("div",{className:(0,l.cn)("relative w-full bg-white dark:bg-gray-800 rounded-xl shadow-2xl animate-slide-up",{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[d]),children:[i&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i}),(0,a.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,a.jsx)(n.Z,{className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:"p-6",children:o})]})]}):null}},1657:function(e,r,t){"use strict";t.d(r,{GS:function(){return i},SY:function(){return n},cn:function(){return s},p6:function(){return l}});var a=t(3167);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.W)(r)}function l(e){return new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}function n(e){let r=new Date(e),t=new Date().getTime()-r.getTime(),a=Math.floor(t/6e4),s=Math.floor(t/36e5),n=Math.floor(t/864e5);return a<1?"Ahora":a<60?"Hace ".concat(a," min"):s<24?"Hace ".concat(s,"h"):n<7?"Hace ".concat(n,"d"):l(r)}function i(e,r){if(0===e.length)return;let t=Object.keys(e[0]),a=[t.join(","),...e.map(e=>t.map(r=>{let t=e[r];return"string"==typeof t&&(t.includes(",")||t.includes('"'))?'"'.concat(t.replace(/"/g,'""'),'"'):t}).join(","))].join("\n"),s=new Blob([a],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),n=URL.createObjectURL(s);l.setAttribute("href",n),l.setAttribute("download",r),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)}}},function(e){e.O(0,[322,971,69,744],function(){return e(e.s=7954)}),_N_E=e.O()}]);